
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>大乐透摇号器（GitHub Pages 版 · 导出到 Excel）</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0b1221" />
<style>
  :root { --bg:#0b1221; --text:#e7eaf6; --accent:#00d4ff; }
  html,body{height:100%}
  body{margin:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'PingFang SC','Microsoft YaHei',sans-serif;background:radial-gradient(circle at 20% 0%, #101b3b 0%, var(--bg) 50%);color:var(--text)}
  header{padding:16px}
  h1{margin:0 0 6px;font-size:20px}
  .sub{font-size:12px;opacity:.85}
  .status{margin-top:8px;display:flex;align-items:center;gap:8px}
  .badge{font-size:11px;padding:4px 8px;border-radius:999px;background:#13304d;border:1px solid rgba(255,255,255,.12)}
  .cards{display:grid;grid-template-columns:1fr;gap:12px;padding:0 16px 96px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:12px}
  .card h3{margin:0 0 8px;font-size:16px}
  .nums{display:flex;flex-wrap:wrap;gap:10px;align-items:center;min-height:48px}
  .pill{display:inline-flex;width:46px;height:46px;border-radius:23px;align-items:center;justify-content:center;font-weight:800;font-size:16px;background:#1f2d4d;border:1px solid rgba(255,255,255,.18)}
  .pill.front{color:#fff}
  .pill.back{color:#fff;background:#2d1f4d;border-color:rgba(255,255,255,.28)}
  .label{font-size:12px;opacity:.8}
  .split{width:100%;height:1px;border-top:1px dashed rgba(255,255,255,.2);margin:8px 0}
  .bar{position:fixed;left:0;right:0;bottom:0;padding:12px 16px;background:linear-gradient(180deg, rgba(16,26,51,.3), rgba(16,26,51,.9));backdrop-filter:blur(8px);border-top:1px solid rgba(255,255,255,.08);display:flex;align-items:center;gap:12px}
  .btn{flex:1;background:linear-gradient(135deg,var(--accent),#7af5ff);color:#00111a;border:none;border-radius:12px;padding:14px 18px;font-weight:800;font-size:16px;box-shadow:0 10px 20px rgba(0,212,255,.28)}
  .btn.secondary{background:linear-gradient(135deg,#ffd86b,#ff7b00); color:#271300;}
  .btn:disabled{opacity:.6}
  .small{font-size:12px;opacity:.85}
  .overlay{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.35);z-index:999}
  .spinner{width:180px;height:180px;position:relative}
  .ball{position:absolute;width:58px;height:58px;border-radius:29px;display:grid;place-items:center;font-weight:900;color:#031421}
  .ball.front{background:radial-gradient(circle,#ffd86b,#ff7b00);box-shadow:0 6px 16px rgba(255,123,0,.35)}
  .ball.back{background:radial-gradient(circle,#9a8cff,#5c3bff);box-shadow:0 6px 16px rgba(92,59,255,.35)}
  .orbit{animation:orbit 1.1s linear infinite}
  @keyframes orbit{0%{transform:rotate(0deg) translate(68px) rotate(0deg)}50%{transform:rotate(180deg) translate(68px) rotate(-180deg)}100%{transform:rotate(360deg) translate(68px) rotate(-360deg)}}
  .flash{animation:flash .35s ease-in-out 5}
  @keyframes flash{0%,100%{filter:brightness(1)}50%{filter:brightness(1.85)}}
  .reveal{animation:pop .35s ease-out}
  @keyframes pop{0%{transform:scale(.6);opacity:.2}100%{transform:scale(1);opacity:1}}
</style>
</head>
<body>
  <header>
    <h1>大乐透摇号器（GitHub Pages 版）</h1>
    <div class="sub">前区 1–35 选 5，后区 1–12 选 2。点击底部按钮即可摇号；支持导出到 Excel（.xls）。</div>
    <div class="status"><span class="badge" id="liveBadge">尝试接入真实历史数据…</span><span class="small" id="ts">准备就绪</span></div>
  </header>
  <section class="cards">
    <div class="card"><h3>A. 完全随机</h3><div class="nums" id="numsA"></div><div class="split"></div><div class="label">规则：前区 5 枚（1–35 不重复，升序）；后区 2 枚（1–12 不重复，升序）。</div></div>
    <div class="card"><h3>B. 历史加权随机</h3><div class="nums" id="numsB"></div><div class="split"></div><div class="label">基于历史频次做权重抽样（仅改变风格，不提升中奖概率）。</div></div>
    <div class="card"><h3>C. 约束组合</h3><div class="nums" id="numsC"></div><div class="split"></div><div class="label">奇偶 3:2 或 2:3；最小间隔≥2；最多 1 组连号；前区和值 70–135。</div></div>
  </section>
  <div class="bar"><button id="startBtn" class="btn">开始摇号</button><button id="exportBtn" class="btn secondary">导出到 Excel</button><div class="small" id="hint">支持分享</div></div>
  <div class="overlay" id="overlay"><div class="spinner"><div class="ball front orbit" style="top:68px; left:68px;">前</div><div class="ball back orbit" style="top:68px; left:68px;">后</div></div></div>
<script>
// PWA SW register
if('serviceWorker' in navigator){ navigator.serviceWorker.register('sw.js').catch(()=>{}); }
const FALLBACK = {data: [{"front": [6, 7, 10, 14, 20], "back": [9, 12]}, {"front": [3, 8, 10, 11, 19], "back": [10, 11]}, {"front": [13, 15, 16, 24, 29], "back": [2, 9]}, {"front": [5, 15, 17, 31, 32], "back": [5, 7]}, {"front": [4, 6, 24, 25, 33], "back": [4, 8]}, {"front": [4, 14, 15, 25, 27], "back": [2, 6]}, {"front": [5, 11, 18, 22, 28], "back": [2, 10]}, {"front": [1, 9, 17, 19, 23], "back": [4, 7]}, {"front": [6, 10, 21, 25, 28], "back": [3, 9]}, {"front": [5, 16, 24, 26, 27], "back": [6, 10]}, {"front": [1, 10, 13, 21, 30], "back": [1, 4]}, {"front": [1, 6, 11, 16, 35], "back": [8, 12]}, {"front": [17, 19, 31, 33, 35], "back": [1, 2]}, {"front": [2, 5, 8, 12, 23], "back": [2, 4]}, {"front": [3, 4, 6, 7, 21], "back": [6, 12]}, {"front": [4, 5, 6, 23, 31], "back": [2, 8]}, {"front": [3, 6, 25, 30, 35], "back": [8, 9]}, {"front": [1, 3, 5, 7, 13], "back": [9, 11]}, {"front": [12, 13, 20, 23, 35], "back": [6, 10]}, {"front": [3, 4, 7, 30, 35], "back": [1, 6]}, {"front": [5, 23, 25, 32, 34], "back": [2, 5]}, {"front": [5, 10, 16, 29, 30], "back": [2, 6]}, {"front": [8, 9, 14, 17, 22], "back": [1, 11]}, {"front": [7, 15, 16, 20, 26], "back": [1, 4]}, {"front": [4, 5, 6, 8, 28], "back": [2, 8]}, {"front": [8, 21, 25, 31, 33], "back": [7, 12]}, {"front": [2, 17, 18, 19, 25], "back": [7, 8]}, {"front": [2, 8, 9, 11, 29], "back": [5, 12]}, {"front": [2, 5, 17, 18, 23], "back": [1, 12]}, {"front": [1, 6, 28, 31, 35], "back": [5, 10]}, {"front": [1, 17, 22, 28, 32], "back": [5, 6]}, {"front": [1, 2, 3, 5, 20], "back": [7, 10]}, {"front": [4, 6, 12, 20, 34], "back": [2, 8]}, {"front": [4, 10, 11, 21, 29], "back": [9, 11]}, {"front": [7, 8, 20, 21, 22], "back": [3, 8]}, {"front": [7, 9, 12, 26, 34], "back": [8, 11]}, {"front": [4, 15, 26, 31, 34], "back": [5, 9]}, {"front": [11, 13, 25, 32, 35], "back": [7, 8]}, {"front": [9, 12, 15, 17, 27], "back": [1, 7]}, {"front": [3, 4, 9, 11, 15], "back": [4, 11]}, {"front": [4, 8, 14, 22, 28], "back": [1, 4]}, {"front": [7, 9, 19, 30, 35], "back": [11, 12]}, {"front": [1, 9, 18, 20, 33], "back": [8, 10]}, {"front": [8, 18, 19, 27, 34], "back": [1, 5]}, {"front": [4, 9, 16, 25, 29], "back": [4, 12]}, {"front": [10, 12, 15, 27, 29], "back": [1, 7]}, {"front": [11, 13, 14, 18, 20], "back": [7, 12]}, {"front": [1, 7, 13, 14, 30], "back": [4, 8]}, {"front": [10, 24, 26, 28, 29], "back": [3, 7]}, {"front": [6, 13, 14, 24, 28], "back": [2, 8]}, {"front": [6, 19, 21, 32, 34], "back": [2, 7]}, {"front": [3, 9, 15, 20, 32], "back": [1, 11]}, {"front": [5, 6, 11, 16, 21], "back": [9, 10]}, {"front": [5, 12, 17, 23, 30], "back": [1, 4]}, {"front": [11, 12, 17, 19, 32], "back": [10, 11]}, {"front": [19, 22, 24, 25, 32], "back": [2, 6]}, {"front": [2, 5, 24, 26, 30], "back": [8, 9]}, {"front": [3, 12, 22, 33, 34], "back": [6, 10]}, {"front": [8, 13, 27, 28, 34], "back": [2, 9]}, {"front": [2, 4, 5, 10, 17], "back": [1, 6]}, {"front": [2, 7, 18, 19, 32], "back": [9, 11]}, {"front": [4, 12, 29, 31, 32], "back": [3, 5]}, {"front": [8, 9, 16, 19, 28], "back": [5, 6]}, {"front": [1, 16, 30, 31, 32], "back": [3, 4]}, {"front": [4, 24, 27, 33, 35], "back": [1, 4]}, {"front": [16, 21, 24, 25, 28], "back": [6, 11]}, {"front": [11, 20, 22, 25, 30], "back": [2, 12]}, {"front": [7, 8, 10, 12, 17], "back": [9, 10]}, {"front": [6, 8, 19, 20, 31], "back": [9, 10]}, {"front": [8, 13, 14, 33, 34], "back": [8, 10]}, {"front": [8, 17, 23, 33, 35], "back": [4, 8]}, {"front": [3, 13, 26, 33, 34], "back": [9, 12]}, {"front": [2, 8, 9, 11, 25], "back": [6, 8]}, {"front": [5, 13, 16, 20, 35], "back": [5, 10]}, {"front": [4, 9, 18, 19, 29], "back": [7, 11]}, {"front": [1, 7, 8, 22, 34], "back": [1, 11]}, {"front": [12, 18, 26, 27, 34], "back": [4, 8]}, {"front": [1, 12, 17, 22, 32], "back": [6, 12]}, {"front": [4, 10, 14, 18, 35], "back": [1, 10]}, {"front": [2, 4, 6, 11, 24], "back": [6, 12]}, {"front": [15, 17, 19, 20, 23], "back": [3, 12]}, {"front": [4, 11, 15, 19, 25], "back": [6, 11]}, {"front": [7, 13, 18, 23, 26], "back": [7, 11]}, {"front": [14, 18, 24, 31, 32], "back": [5, 11]}, {"front": [12, 15, 17, 19, 21], "back": [1, 5]}, {"front": [8, 21, 23, 30, 32], "back": [6, 11]}, {"front": [6, 7, 17, 23, 33], "back": [2, 6]}, {"front": [3, 8, 22, 25, 28], "back": [9, 10]}, {"front": [7, 12, 17, 18, 34], "back": [1, 9]}, {"front": [11, 19, 26, 32, 35], "back": [6, 10]}, {"front": [6, 10, 20, 23, 33], "back": [2, 4]}, {"front": [2, 19, 21, 25, 30], "back": [9, 10]}, {"front": [6, 11, 14, 31, 35], "back": [2, 4]}, {"front": [5, 14, 20, 27, 30], "back": [7, 8]}, {"front": [8, 19, 20, 21, 23], "back": [2, 4]}, {"front": [6, 11, 28, 33, 35], "back": [4, 12]}, {"front": [6, 20, 25, 26, 31], "back": [6, 11]}, {"front": [3, 7, 10, 14, 16], "back": [10, 11]}, {"front": [1, 7, 10, 18, 30], "back": [7, 11]}, {"front": [3, 4, 7, 9, 12], "back": [1, 9]}, {"front": [5, 8, 10, 11, 33], "back": [2, 6]}, {"front": [8, 10, 11, 13, 23], "back": [6, 7]}, {"front": [6, 9, 22, 23, 33], "back": [3, 4]}, {"front": [14, 20, 22, 29, 33], "back": [5, 10]}, {"front": [5, 13, 22, 26, 33], "back": [7, 12]}, {"front": [18, 21, 26, 31, 32], "back": [6, 10]}, {"front": [2, 4, 9, 13, 29], "back": [6, 11]}, {"front": [3, 4, 7, 18, 33], "back": [6, 7]}, {"front": [6, 11, 22, 24, 33], "back": [6, 9]}, {"front": [13, 15, 18, 26, 31], "back": [6, 8]}, {"front": [5, 25, 27, 31, 34], "back": [3, 9]}, {"front": [5, 8, 32, 34, 35], "back": [7, 12]}, {"front": [7, 8, 19, 30, 32], "back": [3, 11]}, {"front": [3, 5, 10, 18, 23], "back": [1, 11]}, {"front": [9, 26, 28, 29, 34], "back": [3, 4]}, {"front": [15, 17, 22, 26, 34], "back": [6, 12]}, {"front": [20, 24, 25, 26, 30], "back": [2, 6]}, {"front": [7, 11, 13, 22, 30], "back": [4, 6]}, {"front": [1, 5, 21, 27, 35], "back": [7, 11]}, {"front": [1, 2, 21, 23, 34], "back": [2, 4]}, {"front": [2, 8, 16, 22, 31], "back": [1, 3]}, {"front": [4, 5, 8, 10, 17], "back": [10, 12]}, {"front": [2, 5, 10, 33, 35], "back": [9, 10]}, {"front": [6, 14, 23, 28, 33], "back": [5, 6]}, {"front": [11, 18, 21, 22, 30], "back": [4, 9]}, {"front": [1, 9, 16, 19, 23], "back": [5, 6]}, {"front": [4, 10, 21, 24, 31], "back": [6, 7]}, {"front": [2, 6, 10, 13, 17], "back": [5, 6]}, {"front": [10, 19, 28, 31, 32], "back": [8, 9]}, {"front": [9, 11, 25, 29, 35], "back": [10, 11]}, {"front": [10, 12, 20, 22, 35], "back": [10, 11]}, {"front": [3, 4, 22, 32, 35], "back": [6, 7]}, {"front": [1, 5, 12, 15, 35], "back": [2, 6]}, {"front": [2, 7, 11, 20, 27], "back": [6, 7]}, {"front": [4, 10, 21, 22, 31], "back": [9, 12]}, {"front": [4, 6, 13, 18, 30], "back": [5, 10]}, {"front": [3, 7, 10, 16, 32], "back": [3, 7]}, {"front": [4, 12, 22, 29, 32], "back": [1, 11]}, {"front": [1, 9, 11, 27, 31], "back": [11, 12]}, {"front": [5, 14, 16, 18, 28], "back": [9, 10]}, {"front": [3, 8, 18, 27, 28], "back": [3, 4]}, {"front": [3, 9, 11, 30, 33], "back": [4, 9]}, {"front": [1, 3, 5, 16, 17], "back": [8, 12]}, {"front": [5, 13, 20, 29, 35], "back": [3, 4]}, {"front": [4, 11, 21, 23, 32], "back": [3, 6]}, {"front": [11, 22, 25, 29, 32], "back": [1, 12]}, {"front": [7, 10, 11, 12, 22], "back": [6, 9]}, {"front": [6, 9, 15, 17, 33], "back": [1, 11]}, {"front": [23, 25, 28, 32, 34], "back": [9, 11]}, {"front": [4, 11, 20, 21, 23], "back": [1, 4]}, {"front": [4, 6, 21, 25, 34], "back": [3, 12]}, {"front": [7, 8, 26, 31, 35], "back": [1, 8]}, {"front": [6, 17, 28, 30, 34], "back": [5, 6]}, {"front": [4, 9, 26, 32, 35], "back": [2, 3]}, {"front": [5, 6, 20, 22, 27], "back": [2, 10]}, {"front": [2, 14, 15, 20, 30], "back": [4, 11]}, {"front": [5, 13, 19, 30, 35], "back": [4, 8]}, {"front": [13, 20, 21, 31, 35], "back": [2, 12]}, {"front": [2, 15, 23, 24, 35], "back": [3, 4]}, {"front": [16, 23, 24, 27, 33], "back": [2, 6]}, {"front": [15, 19, 24, 25, 27], "back": [3, 4]}, {"front": [5, 9, 16, 21, 31], "back": [4, 6]}, {"front": [2, 5, 6, 17, 30], "back": [5, 12]}, {"front": [8, 12, 24, 27, 31], "back": [5, 9]}, {"front": [4, 5, 8, 22, 29], "back": [1, 10]}, {"front": [5, 6, 11, 28, 30], "back": [4, 10]}, {"front": [14, 17, 19, 23, 30], "back": [6, 8]}, {"front": [4, 5, 11, 23, 27], "back": [4, 11]}, {"front": [1, 16, 24, 29, 33], "back": [4, 11]}, {"front": [10, 15, 17, 19, 31], "back": [4, 8]}, {"front": [3, 9, 24, 26, 33], "back": [4, 5]}, {"front": [2, 11, 13, 20, 34], "back": [1, 7]}, {"front": [4, 5, 8, 18, 32], "back": [2, 3]}, {"front": [6, 9, 10, 27, 29], "back": [6, 12]}, {"front": [1, 8, 15, 16, 17], "back": [2, 10]}, {"front": [21, 23, 24, 28, 34], "back": [9, 10]}, {"front": [5, 9, 15, 18, 29], "back": [4, 5]}, {"front": [13, 17, 19, 25, 33], "back": [8, 12]}, {"front": [4, 9, 26, 31, 34], "back": [4, 10]}, {"front": [2, 13, 20, 26, 33], "back": [3, 6]}, {"front": [15, 25, 27, 31, 34], "back": [5, 10]}, {"front": [3, 13, 18, 22, 30], "back": [6, 12]}, {"front": [3, 12, 13, 19, 35], "back": [1, 3]}, {"front": [1, 14, 17, 26, 34], "back": [2, 11]}, {"front": [5, 11, 18, 19, 35], "back": [7, 12]}, {"front": [6, 10, 20, 32, 35], "back": [6, 9]}, {"front": [12, 14, 22, 26, 33], "back": [1, 8]}, {"front": [2, 15, 16, 27, 28], "back": [10, 11]}, {"front": [3, 6, 7, 10, 24], "back": [10, 12]}, {"front": [2, 5, 17, 20, 26], "back": [3, 12]}, {"front": [2, 21, 23, 25, 32], "back": [9, 10]}, {"front": [13, 15, 21, 26, 28], "back": [9, 12]}, {"front": [3, 4, 8, 21, 30], "back": [3, 5]}, {"front": [2, 11, 14, 21, 23], "back": [8, 9]}, {"front": [4, 22, 23, 25, 34], "back": [4, 9]}, {"front": [3, 16, 17, 27, 31], "back": [5, 9]}, {"front": [1, 8, 12, 28, 32], "back": [1, 6]}, {"front": [5, 7, 11, 14, 15], "back": [1, 9]}, {"front": [6, 12, 14, 18, 25], "back": [8, 9]}, {"front": [5, 6, 15, 21, 26], "back": [1, 10]}, {"front": [10, 11, 22, 26, 34], "back": [2, 7]}, {"front": [5, 18, 22, 23, 34], "back": [2, 7]}, {"front": [7, 15, 24, 25, 26], "back": [4, 8]}, {"front": [7, 19, 21, 22, 27], "back": [2, 8]}, {"front": [10, 13, 15, 22, 30], "back": [2, 7]}, {"front": [2, 8, 11, 17, 34], "back": [6, 7]}, {"front": [3, 4, 15, 32, 34], "back": [10, 11]}, {"front": [3, 6, 7, 8, 13], "back": [9, 11]}, {"front": [2, 6, 22, 24, 29], "back": [10, 12]}, {"front": [4, 5, 23, 34, 35], "back": [1, 11]}, {"front": [10, 13, 17, 23, 29], "back": [2, 3]}, {"front": [6, 18, 23, 29, 33], "back": [1, 11]}, {"front": [4, 14, 30, 34, 35], "back": [8, 9]}, {"front": [10, 16, 19, 26, 35], "back": [1, 9]}, {"front": [1, 10, 11, 12, 16], "back": [3, 8]}, {"front": [1, 12, 21, 24, 26], "back": [5, 8]}, {"front": [4, 9, 13, 20, 28], "back": [2, 3]}, {"front": [6, 9, 14, 21, 28], "back": [6, 10]}, {"front": [9, 12, 15, 25, 27], "back": [6, 10]}, {"front": [6, 12, 13, 16, 34], "back": [2, 6]}, {"front": [1, 11, 18, 33, 34], "back": [11, 12]}, {"front": [4, 8, 14, 19, 26], "back": [6, 12]}, {"front": [4, 25, 26, 29, 31], "back": [3, 12]}, {"front": [6, 25, 28, 29, 33], "back": [3, 6]}, {"front": [3, 7, 20, 28, 32], "back": [5, 8]}, {"front": [1, 12, 19, 27, 32], "back": [2, 6]}, {"front": [2, 3, 12, 17, 22], "back": [11, 12]}, {"front": [6, 25, 29, 34, 35], "back": [1, 2]}, {"front": [10, 18, 19, 31, 33], "back": [3, 12]}, {"front": [1, 2, 20, 26, 28], "back": [9, 11]}, {"front": [9, 14, 16, 29, 34], "back": [7, 12]}, {"front": [3, 5, 27, 30, 33], "back": [3, 8]}, {"front": [1, 11, 13, 17, 21], "back": [8, 11]}, {"front": [4, 10, 15, 25, 28], "back": [6, 12]}, {"front": [5, 10, 14, 19, 31], "back": [5, 11]}, {"front": [11, 19, 20, 24, 33], "back": [2, 10]}, {"front": [4, 20, 27, 31, 34], "back": [5, 8]}, {"front": [6, 9, 12, 20, 27], "back": [4, 11]}, {"front": [13, 14, 21, 26, 31], "back": [1, 10]}, {"front": [9, 10, 21, 29, 35], "back": [7, 9]}, {"front": [7, 17, 18, 29, 33], "back": [9, 11]}, {"front": [7, 12, 20, 22, 29], "back": [3, 10]}, {"front": [17, 20, 23, 27, 30], "back": [4, 6]}, {"front": [6, 16, 23, 26, 33], "back": [1, 12]}, {"front": [6, 8, 9, 16, 34], "back": [5, 10]}, {"front": [8, 11, 20, 31, 32], "back": [5, 7]}, {"front": [11, 14, 18, 23, 24], "back": [4, 5]}, {"front": [5, 6, 16, 25, 27], "back": [1, 6]}, {"front": [5, 6, 17, 20, 24], "back": [3, 6]}, {"front": [6, 15, 19, 20, 26], "back": [2, 11]}, {"front": [7, 12, 19, 27, 32], "back": [4, 7]}, {"front": [10, 13, 14, 21, 31], "back": [6, 10]}, {"front": [2, 6, 14, 25, 31], "back": [3, 8]}, {"front": [3, 6, 10, 17, 24], "back": [7, 11]}, {"front": [12, 25, 28, 29, 30], "back": [7, 10]}, {"front": [18, 19, 21, 24, 30], "back": [1, 6]}, {"front": [15, 16, 22, 29, 34], "back": [3, 9]}, {"front": [1, 11, 16, 18, 25], "back": [1, 2]}, {"front": [1, 7, 28, 30, 33], "back": [5, 11]}, {"front": [10, 14, 16, 18, 23], "back": [4, 11]}, {"front": [13, 26, 27, 31, 33], "back": [6, 8]}, {"front": [7, 8, 18, 26, 28], "back": [3, 6]}, {"front": [2, 8, 10, 15, 24], "back": [4, 5]}, {"front": [9, 15, 28, 32, 34], "back": [5, 11]}, {"front": [14, 15, 27, 28, 30], "back": [3, 11]}, {"front": [4, 5, 6, 18, 29], "back": [1, 7]}, {"front": [18, 20, 22, 32, 35], "back": [4, 7]}, {"front": [2, 7, 10, 13, 24], "back": [5, 12]}, {"front": [1, 11, 15, 19, 23], "back": [4, 9]}, {"front": [2, 5, 18, 20, 34], "back": [7, 12]}, {"front": [2, 11, 14, 29, 34], "back": [7, 10]}, {"front": [9, 11, 14, 21, 30], "back": [6, 8]}, {"front": [9, 17, 18, 25, 28], "back": [3, 5]}, {"front": [2, 11, 24, 25, 26], "back": [3, 11]}, {"front": [3, 4, 6, 24, 25], "back": [8, 9]}, {"front": [3, 4, 15, 31, 32], "back": [1, 2]}, {"front": [1, 20, 21, 28, 30], "back": [8, 11]}, {"front": [4, 12, 15, 29, 31], "back": [3, 11]}, {"front": [9, 19, 20, 27, 33], "back": [6, 7]}, {"front": [2, 11, 12, 13, 29], "back": [4, 9]}, {"front": [1, 2, 12, 25, 34], "back": [5, 12]}, {"front": [2, 14, 18, 19, 22], "back": [9, 11]}, {"front": [2, 10, 11, 12, 35], "back": [2, 5]}, {"front": [1, 4, 24, 27, 33], "back": [1, 9]}, {"front": [12, 17, 18, 23, 26], "back": [3, 6]}, {"front": [2, 19, 21, 30, 32], "back": [5, 6]}, {"front": [4, 13, 14, 20, 31], "back": [11, 12]}, {"front": [1, 17, 19, 25, 26], "back": [6, 12]}, {"front": [1, 15, 24, 32, 35], "back": [2, 7]}, {"front": [1, 11, 21, 26, 32], "back": [8, 12]}, {"front": [5, 9, 11, 14, 24], "back": [7, 9]}, {"front": [1, 5, 13, 16, 32], "back": [1, 8]}, {"front": [4, 8, 18, 29, 33], "back": [4, 6]}, {"front": [18, 19, 22, 23, 34], "back": [8, 10]}, {"front": [4, 6, 13, 18, 24], "back": [1, 11]}, {"front": [8, 20, 22, 34, 35], "back": [6, 7]}, {"front": [6, 12, 14, 15, 22], "back": [5, 9]}, {"front": [8, 16, 20, 23, 24], "back": [7, 9]}, {"front": [3, 5, 9, 15, 35], "back": [10, 11]}, {"front": [2, 3, 18, 21, 22], "back": [2, 10]}, {"front": [9, 10, 21, 31, 33], "back": [7, 8]}, {"front": [3, 20, 28, 32, 34], "back": [4, 8]}, {"front": [6, 14, 17, 29, 32], "back": [1, 12]}, {"front": [5, 15, 18, 21, 23], "back": [4, 12]}, {"front": [20, 24, 28, 29, 33], "back": [2, 3]}, {"front": [3, 10, 17, 23, 30], "back": [2, 5]}, {"front": [1, 9, 10, 28, 31], "back": [1, 8]}, {"front": [4, 6, 7, 9, 25], "back": [5, 8]}, {"front": [8, 21, 24, 27, 35], "back": [9, 11]}, {"front": [5, 17, 22, 26, 34], "back": [2, 12]}, {"front": [4, 14, 18, 31, 33], "back": [7, 11]}, {"front": [7, 16, 18, 21, 34], "back": [2, 4]}, {"front": [11, 12, 14, 23, 29], "back": [2, 10]}, {"front": [8, 17, 18, 21, 33], "back": [4, 8]}, {"front": [13, 14, 15, 25, 34], "back": [1, 12]}, {"front": [7, 11, 13, 20, 22], "back": [1, 12]}, {"front": [14, 19, 22, 23, 24], "back": [2, 4]}, {"front": [5, 6, 8, 11, 26], "back": [10, 11]}, {"front": [1, 2, 6, 16, 23], "back": [11, 12]}, {"front": [6, 8, 10, 19, 31], "back": [7, 9]}, {"front": [1, 8, 16, 20, 27], "back": [8, 10]}, {"front": [2, 3, 13, 15, 29], "back": [5, 12]}, {"front": [9, 17, 24, 33, 34], "back": [2, 8]}, {"front": [4, 11, 12, 16, 17], "back": [3, 8]}, {"front": [7, 8, 16, 17, 23], "back": [9, 11]}, {"front": [8, 18, 27, 32, 35], "back": [3, 9]}, {"front": [10, 14, 19, 26, 33], "back": [3, 8]}, {"front": [2, 3, 9, 10, 23], "back": [6, 7]}, {"front": [1, 24, 26, 30, 31], "back": [1, 10]}, {"front": [11, 14, 16, 20, 23], "back": [4, 8]}, {"front": [16, 17, 18, 31, 35], "back": [3, 4]}, {"front": [17, 20, 22, 27, 34], "back": [2, 10]}, {"front": [6, 15, 24, 27, 28], "back": [2, 11]}, {"front": [3, 7, 10, 25, 34], "back": [3, 4]}, {"front": [11, 17, 20, 27, 35], "back": [4, 8]}, {"front": [4, 10, 17, 33, 34], "back": [2, 3]}, {"front": [10, 12, 18, 24, 25], "back": [6, 8]}, {"front": [9, 14, 22, 25, 33], "back": [2, 3]}, {"front": [5, 24, 27, 30, 33], "back": [4, 12]}, {"front": [7, 17, 20, 21, 30], "back": [7, 10]}, {"front": [5, 20, 21, 30, 31], "back": [2, 5]}, {"front": [5, 9, 19, 22, 29], "back": [1, 10]}, {"front": [17, 18, 23, 28, 31], "back": [4, 6]}, {"front": [12, 14, 23, 29, 32], "back": [1, 8]}, {"front": [6, 18, 22, 26, 29], "back": [4, 11]}, {"front": [15, 22, 25, 27, 30], "back": [4, 12]}, {"front": [1, 5, 9, 12, 35], "back": [8, 12]}, {"front": [1, 3, 12, 26, 29], "back": [1, 8]}, {"front": [14, 15, 20, 21, 33], "back": [4, 10]}, {"front": [11, 16, 24, 26, 30], "back": [6, 7]}, {"front": [8, 15, 18, 21, 29], "back": [6, 9]}, {"front": [1, 15, 21, 28, 31], "back": [1, 12]}, {"front": [1, 4, 9, 17, 22], "back": [6, 9]}, {"front": [17, 21, 22, 28, 32], "back": [4, 6]}, {"front": [3, 7, 10, 20, 23], "back": [9, 11]}, {"front": [9, 10, 11, 14, 35], "back": [1, 9]}, {"front": [2, 3, 11, 13, 22], "back": [3, 11]}, {"front": [19, 20, 21, 25, 31], "back": [8, 9]}, {"front": [4, 12, 15, 20, 25], "back": [1, 5]}, {"front": [8, 24, 26, 32, 33], "back": [8, 12]}, {"front": [8, 18, 19, 26, 33], "back": [1, 4]}, {"front": [2, 6, 9, 17, 33], "back": [2, 12]}, {"front": [2, 13, 17, 21, 23], "back": [6, 11]}, {"front": [8, 10, 16, 28, 33], "back": [3, 8]}, {"front": [3, 5, 22, 28, 33], "back": [2, 8]}, {"front": [11, 19, 27, 31, 33], "back": [1, 3]}, {"front": [4, 9, 31, 33, 34], "back": [2, 3]}, {"front": [7, 15, 17, 19, 20], "back": [7, 12]}, {"front": [14, 17, 18, 22, 27], "back": [1, 7]}, {"front": [1, 6, 7, 9, 19], "back": [5, 12]}, {"front": [1, 13, 14, 19, 26], "back": [6, 11]}, {"front": [12, 19, 20, 22, 30], "back": [6, 8]}, {"front": [1, 11, 14, 22, 29], "back": [7, 9]}, {"front": [11, 13, 18, 20, 21], "back": [1, 11]}, {"front": [7, 14, 23, 31, 32], "back": [8, 9]}, {"front": [3, 12, 14, 18, 31], "back": [5, 8]}, {"front": [2, 8, 10, 19, 32], "back": [3, 12]}, {"front": [2, 17, 18, 22, 32], "back": [5, 7]}, {"front": [2, 10, 11, 21, 25], "back": [5, 8]}, {"front": [17, 18, 19, 25, 34], "back": [7, 9]}, {"front": [3, 4, 6, 20, 33], "back": [5, 9]}, {"front": [14, 17, 25, 29, 35], "back": [1, 7]}, {"front": [3, 5, 7, 24, 27], "back": [3, 8]}, {"front": [13, 18, 27, 30, 35], "back": [9, 10]}, {"front": [5, 11, 18, 21, 33], "back": [2, 7]}, {"front": [1, 5, 7, 24, 32], "back": [4, 8]}, {"front": [2, 10, 18, 19, 28], "back": [3, 8]}, {"front": [6, 8, 23, 29, 33], "back": [1, 6]}, {"front": [2, 5, 12, 26, 31], "back": [6, 12]}, {"front": [5, 15, 18, 22, 25], "back": [7, 11]}, {"front": [6, 8, 15, 22, 28], "back": [2, 5]}, {"front": [1, 16, 24, 30, 34], "back": [4, 8]}, {"front": [10, 18, 19, 21, 35], "back": [4, 12]}, {"front": [3, 6, 7, 8, 28], "back": [1, 10]}, {"front": [2, 11, 20, 23, 31], "back": [1, 8]}, {"front": [15, 20, 21, 27, 32], "back": [4, 7]}, {"front": [5, 8, 10, 30, 31], "back": [1, 10]}, {"front": [4, 5, 17, 28, 35], "back": [8, 10]}, {"front": [8, 10, 26, 28, 34], "back": [1, 5]}, {"front": [5, 8, 24, 26, 29], "back": [8, 12]}, {"front": [4, 6, 12, 15, 32], "back": [9, 10]}, {"front": [11, 12, 14, 22, 28], "back": [2, 7]}, {"front": [2, 17, 25, 29, 32], "back": [3, 5]}, {"front": [4, 20, 28, 32, 34], "back": [8, 10]}, {"front": [1, 4, 8, 27, 30], "back": [10, 11]}, {"front": [9, 15, 22, 27, 31], "back": [3, 8]}, {"front": [13, 15, 19, 25, 32], "back": [7, 10]}, {"front": [1, 2, 10, 24, 33], "back": [5, 9]}, {"front": [2, 18, 19, 25, 33], "back": [4, 5]}, {"front": [2, 18, 19, 22, 26], "back": [10, 12]}, {"front": [2, 9, 11, 22, 29], "back": [10, 11]}, {"front": [7, 13, 21, 24, 32], "back": [3, 9]}, {"front": [3, 9, 22, 25, 30], "back": [2, 11]}, {"front": [3, 15, 26, 30, 35], "back": [9, 10]}, {"front": [7, 11, 16, 26, 28], "back": [4, 8]}, {"front": [1, 9, 17, 25, 26], "back": [1, 8]}, {"front": [3, 8, 25, 34, 35], "back": [1, 11]}, {"front": [6, 9, 19, 29, 30], "back": [7, 10]}, {"front": [13, 18, 19, 29, 34], "back": [2, 11]}, {"front": [8, 13, 26, 27, 34], "back": [10, 12]}, {"front": [2, 9, 16, 28, 35], "back": [2, 10]}, {"front": [16, 19, 24, 31, 35], "back": [3, 9]}, {"front": [10, 20, 23, 28, 33], "back": [2, 9]}, {"front": [3, 8, 19, 21, 28], "back": [3, 9]}, {"front": [1, 5, 8, 15, 30], "back": [1, 3]}, {"front": [3, 7, 10, 14, 28], "back": [4, 10]}, {"front": [2, 15, 23, 27, 32], "back": [3, 5]}, {"front": [1, 3, 10, 16, 29], "back": [2, 9]}, {"front": [20, 21, 23, 24, 26], "back": [4, 8]}, {"front": [9, 12, 24, 30, 34], "back": [4, 12]}, {"front": [2, 4, 5, 26, 35], "back": [6, 12]}, {"front": [7, 8, 18, 26, 29], "back": [7, 8]}, {"front": [1, 6, 23, 30, 31], "back": [3, 8]}, {"front": [4, 22, 24, 25, 28], "back": [3, 9]}, {"front": [1, 7, 10, 28, 33], "back": [3, 8]}, {"front": [10, 14, 21, 23, 35], "back": [7, 10]}, {"front": [11, 17, 18, 25, 32], "back": [4, 10]}, {"front": [22, 23, 28, 30, 33], "back": [4, 5]}, {"front": [1, 7, 10, 26, 32], "back": [2, 5]}, {"front": [10, 11, 13, 24, 30], "back": [1, 6]}, {"front": [8, 16, 21, 26, 35], "back": [8, 11]}, {"front": [7, 14, 22, 24, 32], "back": [6, 9]}, {"front": [3, 5, 6, 21, 23], "back": [5, 10]}, {"front": [7, 14, 27, 30, 35], "back": [1, 7]}, {"front": [14, 17, 19, 23, 29], "back": [9, 12]}, {"front": [2, 7, 15, 16, 18], "back": [9, 11]}, {"front": [12, 15, 23, 27, 29], "back": [2, 3]}, {"front": [7, 20, 21, 27, 31], "back": [4, 7]}, {"front": [8, 24, 25, 27, 35], "back": [5, 11]}, {"front": [9, 13, 23, 24, 27], "back": [2, 8]}, {"front": [1, 4, 15, 26, 27], "back": [5, 6]}, {"front": [9, 12, 13, 21, 25], "back": [9, 12]}, {"front": [4, 8, 9, 16, 17], "back": [4, 12]}, {"front": [1, 3, 16, 18, 32], "back": [2, 9]}, {"front": [2, 6, 21, 26, 34], "back": [9, 12]}, {"front": [8, 10, 27, 32, 33], "back": [1, 8]}, {"front": [2, 15, 25, 27, 34], "back": [9, 10]}, {"front": [2, 3, 8, 25, 35], "back": [1, 7]}, {"front": [6, 9, 16, 30, 34], "back": [10, 11]}, {"front": [4, 15, 24, 32, 33], "back": [9, 10]}, {"front": [1, 4, 17, 21, 25], "back": [4, 10]}, {"front": [3, 5, 12, 18, 22], "back": [5, 12]}, {"front": [11, 12, 16, 27, 28], "back": [2, 8]}, {"front": [4, 6, 14, 26, 31], "back": [5, 9]}, {"front": [3, 4, 7, 26, 35], "back": [7, 12]}, {"front": [6, 9, 11, 24, 25], "back": [1, 12]}, {"front": [2, 6, 15, 18, 29], "back": [2, 3]}, {"front": [2, 6, 9, 32, 35], "back": [4, 7]}, {"front": [23, 25, 29, 31, 35], "back": [3, 6]}, {"front": [13, 21, 23, 31, 33], "back": [3, 4]}, {"front": [4, 10, 12, 22, 35], "back": [4, 8]}, {"front": [14, 16, 20, 27, 28], "back": [3, 8]}, {"front": [5, 8, 11, 25, 32], "back": [2, 3]}, {"front": [3, 6, 10, 23, 34], "back": [7, 12]}, {"front": [16, 21, 28, 31, 32], "back": [6, 8]}, {"front": [2, 3, 10, 24, 33], "back": [6, 10]}, {"front": [14, 24, 25, 30, 32], "back": [6, 7]}, {"front": [1, 6, 10, 19, 31], "back": [6, 11]}, {"front": [2, 4, 9, 14, 34], "back": [10, 11]}, {"front": [5, 8, 10, 16, 29], "back": [2, 3]}, {"front": [17, 21, 30, 33, 35], "back": [6, 11]}, {"front": [3, 11, 23, 31, 34], "back": [2, 7]}, {"front": [12, 17, 24, 26, 34], "back": [7, 8]}, {"front": [5, 8, 17, 24, 32], "back": [1, 12]}, {"front": [18, 20, 25, 32, 35], "back": [6, 9]}, {"front": [12, 18, 22, 28, 29], "back": [3, 4]}, {"front": [9, 11, 18, 22, 29], "back": [2, 11]}, {"front": [4, 5, 14, 24, 26], "back": [6, 11]}, {"front": [9, 16, 18, 26, 30], "back": [2, 4]}, {"front": [19, 24, 25, 27, 32], "back": [4, 9]}, {"front": [7, 14, 28, 29, 30], "back": [2, 9]}, {"front": [8, 22, 23, 28, 29], "back": [9, 11]}, {"front": [9, 10, 16, 20, 25], "back": [4, 5]}, {"front": [3, 5, 25, 27, 28], "back": [4, 8]}, {"front": [2, 7, 12, 25, 34], "back": [6, 10]}, {"front": [6, 8, 12, 13, 15], "back": [1, 3]}, {"front": [1, 7, 13, 20, 26], "back": [3, 11]}, {"front": [2, 6, 7, 19, 28], "back": [5, 9]}, {"front": [7, 22, 28, 31, 34], "back": [7, 10]}, {"front": [8, 23, 30, 34, 35], "back": [2, 10]}], frontFreq: {"1": 65, "2": 72, "3": 64, "4": 77, "5": 78, "6": 82, "7": 66, "8": 79, "9": 71, "10": 78, "11": 78, "12": 63, "13": 61, "14": 69, "15": 69, "16": 60, "17": 75, "18": 81, "19": 71, "20": 75, "21": 74, "22": 76, "23": 74, "24": 71, "25": 78, "26": 74, "27": 65, "28": 71, "29": 65, "30": 66, "31": 68, "32": 72, "33": 71, "34": 73, "35": 68}, backFreq: {"1": 78, "2": 82, "3": 76, "4": 89, "5": 66, "6": 95, "7": 75, "8": 94, "9": 90, "10": 87, "11": 88, "12": 80}};
let HIST = JSON.parse(JSON.stringify(FALLBACK));
let LOG = JSON.parse(localStorage.getItem('dlt_log')||'[]');
async function tryLoadLive(){ const badge=document.getElementById('liveBadge'); try{ const resp=await fetch('https://www.zhcw.com/kjxx/dlt/',{mode:'cors'}); if(!resp.ok) throw new Error('HTTP '+resp.status); const html=await resp.text(); const rows=[]; const reLine=/(\d{2})\s+(\d{2})\s+(\d{2})\s+(\d{2})\s+(\d{2})\s+(\d{2})\s+(\d{2})/g; let m; while((m=reLine.exec(html))!==null){ const f=[1,2,3,4,5].map(i=>parseInt(m[i],10)); const b=[6,7].map(i=>parseInt(m[i],10)); rows.push({front:f.sort((a,b)=>a-b), back:b.sort((a,b)=>a-b)});} if(rows.length>=50){ HIST.data=rows.slice(0,300); const f={}, b={}; for(let n=1;n<=35;n++) f[n]=0; for(let n=1;n<=12;n++) b[n]=0; HIST.data.forEach(d=>{ d.front.forEach(n=>f[n]++); d.back.forEach(n=>b[n]++); }); HIST.frontFreq=f; HIST.backFreq=b; badge.textContent='已接入真实数据（近'+HIST.data.length+'期）'; badge.style.background='#0e3d2a'; badge.style.borderColor='rgba(0,255,166,.4)'; } else { badge.textContent='跨域受限，使用内置数据（模拟）'; } }catch(e){ badge.textContent='跨域受限，使用内置数据（模拟）'; }}
const randInt=(min,max)=>Math.floor(Math.random()*(max-min+1))+min;
function sampleUnique(maxN,count){ const arr=Array.from({length:maxN},(_,i)=>i+1); for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]];} return arr.slice(0,count).sort((a,b)=>a-b); }
function weightedPick(weights,used){ const entries=Object.entries(weights).filter(([n])=>!used.has(+n)); const sum=entries.reduce((s,[,w])=>s+w,0); let r=Math.random()*sum; for(const [n,w] of entries){ if((r-=w)<=0) return +n; } return +entries[entries.length-1][0]; }
function toPills(front,back){ const frag=document.createDocumentFragment(); const f=document.createElement('span'); f.className='label'; f.textContent='前区'; frag.appendChild(f); front.forEach(n=>{ const p=document.createElement('div'); p.className='pill front reveal'; p.textContent=n.toString().padStart(2,'0'); frag.appendChild(p); }); const s=document.createElement('span'); s.className='label'; s.style.marginLeft='8px'; s.textContent='后区'; frag.appendChild(s); back.forEach(n=>{ const p=document.createElement('div'); p.className='pill back reveal'; p.textContent=n.toString().padStart(2,'0'); frag.appendChild(p); }); return frag; }
function genA(){ return {front:sampleUnique(35,5), back:sampleUnique(12,2)}; }
function genB(){ const usedF=new Set(), usedB=new Set(), epsF=0.5, epsB=0.5; const wf={}, wb={}; for(let n=1;n<=35;n++) wf[n]=(HIST.frontFreq[n]||0)+epsF; for(let n=1;n<=12;n++) wb[n]=(HIST.backFreq[n]||0)+epsB; const front=[], back=[]; while(front.length<5){ const x=weightedPick(wf,usedF); usedF.add(x); front.push(x);} while(back.length<2){ const x=weightedPick(wb,usedB); usedB.add(x); back.push(x);} front.sort((a,b)=>a-b); back.sort((a,b)=>a-b); return {front,back}; }
function genC(){ const ok=(arr)=>{ const odd=arr.filter(x=>x%2===1).length; const even=arr.length-odd; const condParity=(odd===3&&even===2)||(odd===2&&even===3); const condGap=arr.every((x,i)=>i===0||x-arr[i-1]>=2); let consec=0; for(let i=1;i<arr.length;i++) if(arr[i]===arr[i-1]+1) consec++; const condConsec=consec<=1; const sum=arr.reduce((s,x)=>s+x,0); const condSum=sum>=70&&sum<=135; return condParity&&condGap&&condConsec&&condSum; }; let front; let attempts=0; do{ front=sampleUnique(35,5); attempts++; if(attempts>5000) break; }while(!ok(front)); const back=sampleUnique(12,2); return {front,back}; }
function renderResult(id,res){ const el=document.getElementById(id); el.innerHTML=''; el.appendChild(toPills(res.front,res.back)); el.classList.add('flash'); setTimeout(()=>el.classList.remove('flash'),600); }
function runAll(){ const A=genA(), B=genB(), C=genC(); renderResult('numsA',A); renderResult('numsB',B); renderResult('numsC',C); const rec={ ts:new Date().toISOString(), A, B, C }; LOG.unshift(rec); LOG=LOG.slice(0,500); localStorage.setItem('dlt_log', JSON.stringify(LOG)); }
const startBtn=document.getElementById('startBtn'), exportBtn=document.getElementById('exportBtn'), overlay=document.getElementById('overlay'), ts=document.getElementById('ts'), hint=document.getElementById('hint');
startBtn.addEventListener('click',()=>{ startBtn.disabled=true; ts.textContent='摇号中…'; overlay.style.display='grid'; setTimeout(()=>{ overlay.style.display='none'; runAll(); ts.textContent='完成（点击可再次摇号）'; startBtn.disabled=false; }, 1300); });
function collectText(){ const get=(id)=>Array.from(document.querySelectorAll('#'+id+' .pill')).map(x=>x.textContent).join(' '); return 'A:'+get('numsA')+'
B:'+get('numsB')+'
C:'+get('numsC'); }
if(navigator.share){ hint.textContent='分享'; hint.style.textDecoration='underline'; hint.style.cursor='pointer'; hint.addEventListener('click',async()=>{ try{ await navigator.share({ title:'我的摇号结果', text:collectText() }); }catch(e){} }); } else { hint.textContent='长按复制号码'; }
function exportExcel(){
  const header = '<table border=1><tr><th>时间</th><th>模式</th><th>前区</th><th>后区</th></tr>';
  const rows = LOG.map(r => {
    const fmt = (arr) => arr.map(x=>x.toString().padStart(2,'0')).join(' ');
    const a=`<tr><td>${new Date(r.ts).toLocaleString()}</td><td>A</td><td>${fmt(r.A.front)}</td><td>${fmt(r.A.back)}</td></tr>`;
    const b=`<tr><td>${new Date(r.ts).toLocaleString()}</td><td>B</td><td>${fmt(r.B.front)}</td><td>${fmt(r.B.back)}</td></tr>`;
    const c=`<tr><td>${new Date(r.ts).toLocaleString()}</td><td>C</td><td>${fmt(r.C.front)}</td><td>${fmt(r.C.back)}</td></tr>`;
    return a+b+c;
  }).join('');
  const html = `<!DOCTYPE html><html><head><meta charset="utf-8"></head><body>${header}${rows}</table></body></html>`;
  const blob = new Blob([html], { type: 'application/vnd.ms-excel' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  const ts = new Date();
  const name = `DLT_Results_${ts.getFullYear()}${String(ts.getMonth()+1).padStart(2,'0')}${String(ts.getDate()).padStart(2,'0')}_${String(ts.getHours()).padStart(2,'0')}${String(ts.getMinutes()).padStart(2,'0')}${String(ts.getSeconds()).padStart(2,'0')}.xls`;
  a.href = url; a.download = name; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
}
exportBtn.addEventListener('click', exportExcel);

tryLoadLive().then(()=> runAll());
</script>
</body>
</html>
